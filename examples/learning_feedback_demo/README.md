# Learning Retrieval - 反馈收集示例

这个示例展示了如何使用 LangChain-Go 的学习型检索系统中的反馈收集功能。

## 功能演示

1. **记录查询和结果** - 记录用户查询和检索返回的文档
2. **收集显式反馈** - 收集用户的点赞、评分、评论等
3. **收集隐式反馈** - 收集用户的点击、阅读、复制等行为
4. **查询反馈汇总** - 获取单个查询的完整反馈数据
5. **聚合统计** - 分析所有查询的整体表现

## 运行示例

```bash
cd examples/learning_feedback_demo
go run main.go
```

## 输出示例

```
=== LangChain-Go Learning Retrieval - 反馈收集示例 ===

1. 记录查询和检索结果
✓ 已记录查询: 什么是机器学习？
✓ 已记录 2 个检索结果

2. 收集显式反馈
✓ 用户点赞
✓ 用户评分: 5 星

3. 收集隐式反馈
✓ 用户点击了第一个文档
✓ 用户阅读文档 120 秒

4. 获取查询反馈汇总
查询: 什么是机器学习？
策略: hybrid
结果数: 2
平均评分: 5.0/5
点击率: 50.0%
平均阅读时长: 2m0s

5. 模拟更多查询...
✓ 已添加 5 个测试查询

6. 聚合统计
总查询数: 6
平均评分: 4.17/5
正面反馈率: 16.7%
负面反馈率: 0.0%
平均点击率: 50.0%
平均阅读时长: 20s

=== 示例完成 ===
```

## 核心概念

### 显式反馈

用户主动提供的反馈：
- **正面/负面** (`FeedbackTypePositive`/`FeedbackTypeNegative`) - 简单的点赞/点踩
- **评分** (`FeedbackTypeRating`) - 1-5 星评分
- **评论** (`FeedbackTypeComment`) - 文本评论

### 隐式反馈

从用户行为中推断的反馈：
- **点击** (`ActionClick`) - 用户点击了某个文档
- **阅读** (`ActionRead`) - 用户阅读文档的时长
- **复制** (`ActionCopy`) - 用户复制了内容
- **下载** (`ActionDownload`) - 用户下载了文档
- **忽略** (`ActionIgnore`) - 用户跳过了某个结果
- **跳过** (`ActionSkip`) - 用户立即关闭

### 聚合指标

- **平均评分** - 所有评分的平均值
- **点击率 (CTR)** - 被点击的文档占总文档的比例
- **正面/负面率** - 正面/负面反馈占总反馈的比例
- **平均阅读时长** - 用户阅读文档的平均时间

## 存储选项

### 内存存储

适合测试和原型开发：

```go
storage := feedback.NewMemoryStorage()
```

### PostgreSQL 存储

适合生产环境：

```go
db, _ := sql.Open("postgres", "postgres://...")
storage := feedback.NewPostgreSQLStorage(db)

// 初始化数据库 Schema
storage.(*feedback.PostgreSQLStorage).InitSchema(ctx)
```

## 应用场景

1. **检索质量评估** - 通过用户反馈评估检索结果的质量
2. **参数优化** - 基于反馈数据自动调整检索参数
3. **A/B 测试** - 对比不同检索策略的效果
4. **用户满意度监控** - 实时监控用户满意度
5. **问题查询识别** - 发现低质量查询并改进

## 下一步

- 查看 **Phase 2: 检索质量评估** 示例
- 查看 **Phase 3: 参数优化** 示例
- 查看 **Phase 4: A/B 测试** 示例
