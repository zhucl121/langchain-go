# v0.6.1 çŽ¯å¢ƒå‡†å¤‡æŒ‡å—

**ç‰ˆæœ¬**: v0.6.1  
**ä¸»é¢˜**: MCP & A2A å¼€å‘çŽ¯å¢ƒé…ç½®

---

## ðŸ“‹ ç³»ç»Ÿè¦æ±‚

### åŸºç¡€è¦æ±‚

- **Go ç‰ˆæœ¬**: 1.22+ ï¼ˆéœ€è¦æ³›åž‹æ”¯æŒï¼‰
- **æ“ä½œç³»ç»Ÿ**: Linux / macOS / Windows
- **å†…å­˜**: 4GB+ æŽ¨è
- **ç£ç›˜ç©ºé—´**: 2GB+

### å¿…éœ€å·¥å…·

```bash
# Go å·¥å…·é“¾
go version  # ç¡®ä¿ >= 1.22

# Git
git --version

# Makeï¼ˆå¯é€‰ï¼Œç”¨äºŽæž„å»ºè„šæœ¬ï¼‰
make --version
```

---

## ðŸ”§ å¼€å‘ä¾èµ–

### æ–°å¢žä¾èµ–ï¼ˆv0.6.1ï¼‰

```bash
# WebSocket æ”¯æŒï¼ˆMCPï¼‰
go get github.com/gorilla/websocket@v1.5.1

# SSE æ”¯æŒï¼ˆMCPï¼‰
go get github.com/r3labs/sse/v2@v2.10.0

# gRPC æ”¯æŒï¼ˆA2Aï¼‰
go get google.golang.org/grpc@v1.60.0
go get google.golang.org/protobuf@v1.32.0
```

### å®Œæ•´ä¾èµ–åˆ—è¡¨

æŸ¥çœ‹ `go.mod` æ–‡ä»¶èŽ·å–å®Œæ•´ä¾èµ–ã€‚

---

## ðŸ³ å¤–éƒ¨æœåŠ¡

### 1. Consulï¼ˆA2A Agent æ³¨å†Œä¸­å¿ƒï¼‰

#### Docker å¿«é€Ÿå¯åŠ¨

```bash
# å¯åŠ¨ Consul
docker run -d \
  --name consul \
  -p 8500:8500 \
  -p 8600:8600/udp \
  consul:latest agent -server -ui -bootstrap-expect=1 -client=0.0.0.0

# éªŒè¯
curl http://localhost:8500/v1/agent/self
```

#### è®¿é—® UI

æµè§ˆå™¨è®¿é—®: http://localhost:8500/ui

#### é…ç½®è¯´æ˜Ž

```go
// Go ä»£ç ä¸­çš„ Consul é…ç½®
consulConfig := &api.Config{
    Address: "localhost:8500",
    Scheme:  "http",
}
```

---

### 2. Claude Desktopï¼ˆMCP å®¢æˆ·ç«¯ï¼‰

#### å®‰è£… Claude Desktop

1. è®¿é—® [Claude Desktop](https://claude.ai/download)
2. ä¸‹è½½å¹¶å®‰è£…é€‚åˆä½ ç³»ç»Ÿçš„ç‰ˆæœ¬
3. å¯åŠ¨ Claude Desktop

#### é…ç½® MCP Server

**macOS/Linux**: `~/.config/claude/claude_desktop_config.json`  
**Windows**: `%APPDATA%\Claude\claude_desktop_config.json`

```json
{
  "mcpServers": {
    "langchain-go": {
      "command": "/path/to/your/mcp_server_demo",
      "args": [],
      "env": {
        "OPENAI_API_KEY": "your-api-key-here"
      }
    }
  }
}
```

#### éªŒè¯è¿žæŽ¥

1. é‡å¯ Claude Desktop
2. åœ¨èŠå¤©ä¸­è¯¢é—®ï¼š"åˆ—å‡ºå¯ç”¨çš„å·¥å…·"
3. åº”è¯¥èƒ½çœ‹åˆ°ä½ çš„ MCP Server æä¾›çš„å·¥å…·

---

### 3. Redisï¼ˆå¯é€‰ï¼Œç”¨äºŽç¼“å­˜ï¼‰

```bash
# Docker å¯åŠ¨ Redis
docker run -d \
  --name redis \
  -p 6379:6379 \
  redis:latest

# éªŒè¯
redis-cli ping  # åº”è¿”å›ž PONG
```

---

### 4. PostgreSQLï¼ˆå¯é€‰ï¼Œç”¨äºŽæŒä¹…åŒ–ï¼‰

```bash
# Docker å¯åŠ¨ PostgreSQL
docker run -d \
  --name postgres \
  -e POSTGRES_PASSWORD=postgres \
  -e POSTGRES_DB=langchain \
  -p 5432:5432 \
  postgres:15

# éªŒè¯
psql -h localhost -U postgres -d langchain
```

---

## ðŸ› ï¸ å¼€å‘å·¥å…·

### IDE æŽ¨è

#### VS Code

**æŽ¨èæ’ä»¶**:
- Go (golang.go)
- Go Test Explorer
- gopls
- REST Clientï¼ˆæµ‹è¯• APIï¼‰

**é…ç½®** (`.vscode/settings.json`):
```json
{
  "go.useLanguageServer": true,
  "go.lintTool": "golangci-lint",
  "go.formatTool": "goimports",
  "go.testTimeout": "5m"
}
```

#### GoLand

å¼€ç®±å³ç”¨ï¼Œæ— éœ€é¢å¤–é…ç½®ã€‚

---

### ä»£ç è´¨é‡å·¥å…·

```bash
# golangci-lint
go install github.com/golangci/golangci-lint/cmd/golangci-lint@latest

# staticcheck
go install honnef.co/go/tools/cmd/staticcheck@latest

# goimports
go install golang.org/x/tools/cmd/goimports@latest
```

---

## ðŸ“¦ é¡¹ç›®è®¾ç½®

### 1. å…‹éš†ä»“åº“

```bash
git clone https://github.com/zhucl121/langchain-go.git
cd langchain-go
```

### 2. ä¸‹è½½ä¾èµ–

```bash
go mod download
```

### 3. æž„å»ºé¡¹ç›®

```bash
# æž„å»ºæ‰€æœ‰ç¤ºä¾‹
make build

# æˆ–æ‰‹åŠ¨æž„å»º
go build ./...
```

### 4. è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
go test ./...

# è¿è¡Œç‰¹å®šåŒ…æµ‹è¯•
go test ./pkg/protocols/mcp/...
go test ./pkg/protocols/a2a/...

# æŸ¥çœ‹è¦†ç›–çŽ‡
go test -cover ./...
```

---

## ðŸ§ª æµ‹è¯•çŽ¯å¢ƒ

### Docker Compose ä¸€é”®å¯åŠ¨

åˆ›å»º `docker-compose.dev.yml`:

```yaml
version: '3.8'

services:
  consul:
    image: consul:latest
    ports:
      - "8500:8500"
      - "8600:8600/udp"
    command: agent -server -ui -bootstrap-expect=1 -client=0.0.0.0

  redis:
    image: redis:latest
    ports:
      - "6379:6379"

  postgres:
    image: postgres:15
    environment:
      POSTGRES_PASSWORD: postgres
      POSTGRES_DB: langchain
    ports:
      - "5432:5432"
```

å¯åŠ¨æ‰€æœ‰æœåŠ¡:

```bash
docker-compose -f docker-compose.dev.yml up -d
```

åœæ­¢æ‰€æœ‰æœåŠ¡:

```bash
docker-compose -f docker-compose.dev.yml down
```

---

## ðŸ” çŽ¯å¢ƒå˜é‡

### åˆ›å»º `.env` æ–‡ä»¶

```bash
# LLM API Keys
OPENAI_API_KEY=sk-...
ANTHROPIC_API_KEY=sk-ant-...

# Consul
CONSUL_ADDRESS=localhost:8500

# Redis
REDIS_ADDRESS=localhost:6379
REDIS_PASSWORD=

# PostgreSQL
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DB=langchain

# MCP
MCP_SERVER_PORT=8080

# A2A
A2A_REGISTRY_TYPE=consul  # consul or local
A2A_AGENT_ID=agent-1
```

### åŠ è½½çŽ¯å¢ƒå˜é‡

```bash
# ä½¿ç”¨ direnvï¼ˆæŽ¨èï¼‰
brew install direnv
echo 'eval "$(direnv hook zsh)"' >> ~/.zshrc

# åœ¨é¡¹ç›®ç›®å½•åˆ›å»º .envrc
cat > .envrc << 'EOF'
export $(cat .env | xargs)
EOF

direnv allow
```

æˆ–è€…åœ¨ä»£ç ä¸­åŠ è½½:

```go
import "github.com/joho/godotenv"

func init() {
    godotenv.Load()
}
```

---

## ðŸš€ å¿«é€ŸéªŒè¯

### éªŒè¯ MCP

```bash
# 1. æž„å»º MCP Server ç¤ºä¾‹
cd examples/mcp_server_demo
go build -o mcp_server

# 2. è¿è¡Œ
./mcp_server

# 3. åœ¨å¦ä¸€ä¸ªç»ˆç«¯æµ‹è¯•
cd examples/mcp_client_demo
go run main.go
```

### éªŒè¯ A2A

```bash
# 1. ç¡®ä¿ Consul è¿è¡Œ
docker ps | grep consul

# 2. è¿è¡Œ A2A ç¤ºä¾‹
cd examples/a2a_basic_demo
go run main.go

# 3. æ£€æŸ¥ Consul UI
# è®¿é—® http://localhost:8500/ui
# åº”è¯¥èƒ½çœ‹åˆ°æ³¨å†Œçš„ Agent
```

### éªŒè¯åè®®æ¡¥æŽ¥

```bash
# è¿è¡Œæ¡¥æŽ¥ç¤ºä¾‹
cd examples/protocol_bridge_demo
go run main.go
```

---

## ðŸ› å¸¸è§é—®é¢˜

### 1. Go ç‰ˆæœ¬è¿‡ä½Ž

**é—®é¢˜**: `package embed is not in GOROOT`

**è§£å†³**:
```bash
# å‡çº§ Go
go version  # æ£€æŸ¥å½“å‰ç‰ˆæœ¬

# macOS
brew upgrade go

# Linux
wget https://go.dev/dl/go1.22.0.linux-amd64.tar.gz
sudo tar -C /usr/local -xzf go1.22.0.linux-amd64.tar.gz
```

---

### 2. Consul è¿žæŽ¥å¤±è´¥

**é—®é¢˜**: `connection refused`

**è§£å†³**:
```bash
# æ£€æŸ¥ Consul æ˜¯å¦è¿è¡Œ
docker ps | grep consul

# é‡å¯ Consul
docker restart consul

# æ£€æŸ¥ç«¯å£
netstat -an | grep 8500
```

---

### 3. Claude Desktop æ— æ³•è¿žæŽ¥

**é—®é¢˜**: MCP Server æœªæ˜¾ç¤ºåœ¨ Claude Desktop

**è§£å†³**:
1. æ£€æŸ¥é…ç½®æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®
2. æ£€æŸ¥ MCP Server å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„
3. é‡å¯ Claude Desktop
4. æŸ¥çœ‹ Claude Desktop æ—¥å¿—:
   - macOS: `~/Library/Logs/Claude/`
   - Windows: `%APPDATA%\Claude\logs\`

---

### 4. gRPC ç¼–è¯‘é”™è¯¯

**é—®é¢˜**: `protoc-gen-go: program not found or is not executable`

**è§£å†³**:
```bash
# å®‰è£… protoc
brew install protobuf  # macOS
apt install protobuf-compiler  # Ubuntu

# å®‰è£… Go æ’ä»¶
go install google.golang.org/protobuf/cmd/protoc-gen-go@latest
go install google.golang.org/grpc/cmd/protoc-gen-go-grpc@latest
```

---

### 5. ä¾èµ–ä¸‹è½½å¤±è´¥

**é—®é¢˜**: `timeout` æˆ– `connection refused`

**è§£å†³**:
```bash
# é…ç½® Go ä»£ç†ï¼ˆä¸­å›½å¤§é™†ï¼‰
export GOPROXY=https://goproxy.cn,direct

# æˆ–
export GOPROXY=https://mirrors.aliyun.com/goproxy/,direct

# é‡æ–°ä¸‹è½½
go mod download
```

---

## ðŸ“Š æ€§èƒ½æµ‹è¯•çŽ¯å¢ƒ

### åŸºå‡†æµ‹è¯•

```bash
# è¿è¡ŒåŸºå‡†æµ‹è¯•
go test -bench=. -benchmem ./pkg/protocols/mcp/...
go test -bench=. -benchmem ./pkg/protocols/a2a/...

# ç”Ÿæˆ CPU profile
go test -bench=. -cpuprofile=cpu.prof ./pkg/protocols/mcp/...
go tool pprof cpu.prof

# ç”Ÿæˆå†…å­˜ profile
go test -bench=. -memprofile=mem.prof ./pkg/protocols/mcp/...
go tool pprof mem.prof
```

### è´Ÿè½½æµ‹è¯•

ä½¿ç”¨ç¤ºä¾‹ç¨‹åºè¿›è¡Œè´Ÿè½½æµ‹è¯•:

```bash
# å¯åŠ¨ A2A Agent
cd examples/a2a_distributed_demo
./start_agents.sh

# è¿è¡Œè´Ÿè½½æµ‹è¯•
cd tests/load
go run load_test.go -agents=10 -tasks=1000
```

---

## ðŸ” è°ƒè¯•æŠ€å·§

### 1. å¯ç”¨è°ƒè¯•æ—¥å¿—

```go
import "log/slog"

// è®¾ç½®æ—¥å¿—çº§åˆ«
slog.SetLogLoggerLevel(slog.LevelDebug)
```

### 2. ä½¿ç”¨ Delve è°ƒè¯•å™¨

```bash
# å®‰è£… Delve
go install github.com/go-delve/delve/cmd/dlv@latest

# è°ƒè¯•ç¨‹åº
dlv debug examples/mcp_server_demo/main.go

# æ–­ç‚¹
(dlv) break main.main
(dlv) continue
```

### 3. è·Ÿè¸ª MCP æ¶ˆæ¯

```go
// å¯ç”¨ MCP æ¶ˆæ¯æ—¥å¿—
server := mcp.NewServer(mcp.ServerConfig{
    Debug: true,  // æ‰“å°æ‰€æœ‰æ¶ˆæ¯
})
```

### 4. ç›‘æŽ§ A2A æ³¨å†Œ

```bash
# å®žæ—¶æŸ¥çœ‹ Consul æ³¨å†Œ
watch -n 1 'curl -s http://localhost:8500/v1/agent/services | jq'
```

---

## ðŸ“š å­¦ä¹ èµ„æº

### å®˜æ–¹æ–‡æ¡£

- [MCP è§„èŒƒ](./V0.6.1_MCP_SPEC.md)
- [A2A è§„èŒƒ](./V0.6.1_A2A_SPEC.md)
- [ç”¨æˆ·æŒ‡å—](./V0.6.1_USER_GUIDE.md)

### ç¤ºä¾‹ä»£ç 

- `examples/mcp_server_demo/` - MCP Server å®Œæ•´ç¤ºä¾‹
- `examples/a2a_collaboration_demo/` - A2A åä½œç¤ºä¾‹
- `examples/protocol_bridge_demo/` - åè®®æ¡¥æŽ¥ç¤ºä¾‹

### å¤–éƒ¨èµ„æº

- [MCP å®˜æ–¹ç½‘ç«™](https://modelcontextprotocol.io/)
- [Consul æ–‡æ¡£](https://www.consul.io/docs)
- [gRPC Go æ•™ç¨‹](https://grpc.io/docs/languages/go/)

---

## âœ… çŽ¯å¢ƒæ£€æŸ¥æ¸…å•

å¼€å‘å‰è¯·ç¡®è®¤:

- [ ] Go 1.22+ å·²å®‰è£…
- [ ] Docker å·²å®‰è£…å¹¶è¿è¡Œ
- [ ] Consul å·²å¯åŠ¨ï¼ˆå¦‚éœ€ A2Aï¼‰
- [ ] Claude Desktop å·²å®‰è£…ï¼ˆå¦‚éœ€ MCP é›†æˆï¼‰
- [ ] çŽ¯å¢ƒå˜é‡å·²é…ç½®
- [ ] ä¾èµ–å·²ä¸‹è½½ (`go mod download`)
- [ ] æµ‹è¯•é€šè¿‡ (`go test ./...`)
- [ ] ç¤ºä¾‹å¯è¿è¡Œ

---

## ðŸš€ å¼€å§‹å¼€å‘

çŽ¯å¢ƒå‡†å¤‡å°±ç»ªåŽ:

1. é˜…è¯» [å®žæ–½è®¡åˆ’](./V0.6.1_IMPLEMENTATION_PLAN.md)
2. æŸ¥çœ‹ [å¼€å‘è¿›åº¦](./V0.6.1_PROGRESS.md)
3. é€‰æ‹©ä¸€ä¸ª Phase å¼€å§‹å¼€å‘
4. è¿è¡Œæµ‹è¯•éªŒè¯
5. æäº¤ä»£ç 

---

**å‡†å¤‡å®Œæ¯•ï¼Œå¼€å§‹æž„å»º v0.6.1ï¼** ðŸŽ¯

**åˆ›å»ºæ—¥æœŸ**: 2026-01-22  
**æœ€åŽæ›´æ–°**: 2026-01-22
