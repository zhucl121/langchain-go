# v0.6.1 é›†æˆæŒ‡å—

**ç‰ˆæœ¬**: v0.6.1  
**ä¸»é¢˜**: ä¸å¤–éƒ¨å·¥å…·å’Œç³»ç»Ÿçš„é›†æˆ  
**æ—¥æœŸ**: 2026-01-22

---

## ğŸ“‹ ç›®å½•

- [ä¸ Claude Desktop é›†æˆ](#ä¸-claude-desktop-é›†æˆ)
- [ä¸å…¶ä»– MCP å·¥å…·é›†æˆ](#ä¸å…¶ä»–-mcp-å·¥å…·é›†æˆ)
- [è·¨è¯­è¨€ Agent åä½œ](#è·¨è¯­è¨€-agent-åä½œ)
- [ä¼ä¸šç³»ç»Ÿé›†æˆ](#ä¼ä¸šç³»ç»Ÿé›†æˆ)
- [äº‘å¹³å°éƒ¨ç½²](#äº‘å¹³å°éƒ¨ç½²)

---

## ä¸ Claude Desktop é›†æˆ

### 1. åŸºç¡€é›†æˆ

#### åˆ›å»º MCP Server

```go
package main

import (
    "context"
    "log"
    "os"
    
    "github.com/zhucl121/langchain-go/pkg/protocols/mcp"
    "github.com/zhucl121/langchain-go/core/tools"
    "github.com/zhucl121/langchain-go/core/chat/providers/openai"
)

func main() {
    // åˆ›å»º MCP Server
    server := mcp.NewServer(mcp.ServerConfig{
        Name:        "company-ai-server",
        Version:     "1.0.0",
        Description: "å…¬å¸ AI æœåŠ¡å™¨",
    })
    
    // æ³¨å†Œå·¥å…·
    calculator := tools.NewCalculatorTool()
    search := tools.NewDuckDuckGoSearchTool(nil)
    server.RegisterTool(calculator)
    server.RegisterTool(search)
    
    // æ³¨å†Œèµ„æº
    fsProvider := mcp.NewFileSystemProvider("/data/documents")
    server.RegisterResource(&mcp.Resource{
        URI:  "file:///documents",
        Name: "Company Documents",
    }, fsProvider)
    
    // é…ç½® LLMï¼ˆç”¨äºé‡‡æ ·ï¼‰
    llm := openai.New(openai.Config{
        APIKey: os.Getenv("OPENAI_API_KEY"),
        Model:  "gpt-4",
    })
    server.SetLLM(llm)
    
    // å¯åŠ¨ Server
    transport := mcp.NewStdioTransport()
    log.Println("MCP Server å¯åŠ¨æˆåŠŸ")
    
    if err := server.Serve(context.Background(), transport); err != nil {
        log.Fatal(err)
    }
}
```

#### æ„å»ºå¯æ‰§è¡Œæ–‡ä»¶

```bash
# æ„å»º
go build -o company_mcp_server main.go

# ç¡®ä¿å¯æ‰§è¡Œ
chmod +x company_mcp_server

# æµ‹è¯•è¿è¡Œ
./company_mcp_server
```

#### é…ç½® Claude Desktop

**macOS**: ç¼–è¾‘ `~/.config/claude/claude_desktop_config.json`

```json
{
  "mcpServers": {
    "company": {
      "command": "/path/to/company_mcp_server",
      "args": [],
      "env": {
        "OPENAI_API_KEY": "sk-...",
        "DATA_PATH": "/data/documents"
      }
    }
  }
}
```

**Windows**: ç¼–è¾‘ `%APPDATA%\Claude\claude_desktop_config.json`

```json
{
  "mcpServers": {
    "company": {
      "command": "C:\\path\\to\\company_mcp_server.exe",
      "args": [],
      "env": {
        "OPENAI_API_KEY": "sk-..."
      }
    }
  }
}
```

#### é‡å¯ Claude Desktop

é‡å¯åï¼ŒClaude Desktop ä¼šè‡ªåŠ¨è¿æ¥åˆ°ä½ çš„ MCP Serverã€‚

### 2. é«˜çº§é›†æˆ

#### å¤šä¸ªèµ„æºæä¾›è€…

```go
// æ–‡ä»¶ç³»ç»Ÿ
fsProvider := mcp.NewFileSystemProvider("/data")
server.RegisterResource(&mcp.Resource{
    URI:  "file:///data",
    Name: "Local Files",
}, fsProvider)

// æ•°æ®åº“
dbProvider := mcp.NewDatabaseProvider(db, mcp.DatabaseConfig{
    Type:   "postgresql",
    Tables: []string{"customers", "orders"},
})
server.RegisterResource(&mcp.Resource{
    URI:  "db://company",
    Name: "Company Database",
}, dbProvider)

// å‘é‡å­˜å‚¨
vsProvider := mcp.NewVectorStoreProvider(vectorStore, mcp.VectorStoreConfig{
    CollectionName: "knowledge_base",
})
server.RegisterResource(&mcp.Resource{
    URI:  "vector://kb",
    Name: "Knowledge Base",
}, vsProvider)

// GitHub
githubProvider := mcp.NewGitHubProvider(mcp.GitHubConfig{
    Token: os.Getenv("GITHUB_TOKEN"),
    Owner: "company",
    Repo:  "docs",
})
server.RegisterResource(&mcp.Resource{
    URI:  "github://company/docs",
    Name: "GitHub Documentation",
}, githubProvider)
```

#### æƒé™æ§åˆ¶ï¼ˆé›†æˆ v0.6.0 RBACï¼‰

```go
// åˆ›å»º RBAC Manager
rbacManager := rbac.NewDefaultRBACManager(store, cache)

// é…ç½® MCP Server ä½¿ç”¨ RBAC
server := mcp.NewServer(mcp.ServerConfig{
    Name: "secure-server",
    Auth: mcp.AuthConfig{
        Enabled: true,
        RBAC:    rbacManager,
    },
})

// ä¸ºèµ„æºè®¾ç½®æƒé™
resource := &mcp.Resource{
    URI:  "db://sensitive_data",
    Name: "Sensitive Data",
    Metadata: map[string]any{
        "rbac_resource": "database",
        "rbac_action":   "read",
        "rbac_scope":    "tenant",
    },
}
```

#### å®¡è®¡æ—¥å¿—ï¼ˆé›†æˆ v0.6.0 å®¡è®¡ï¼‰

```go
// é…ç½®å®¡è®¡æ—¥å¿—
auditLogger := audit.NewAuditLogger(auditStorage)

// æ·»åŠ å®¡è®¡ä¸­é—´ä»¶
server.Use(mcp.AuditMiddleware(auditLogger))

// æ‰€æœ‰æ“ä½œè‡ªåŠ¨è®°å½•å®¡è®¡æ—¥å¿—
```

---

## ä¸å…¶ä»– MCP å·¥å…·é›†æˆ

### 1. è¿æ¥åˆ°å…¶ä»– MCP Server

#### MCP Client ç¤ºä¾‹

```go
package main

import (
    "context"
    "fmt"
    "log"
    
    "github.com/zhucl121/langchain-go/pkg/protocols/mcp"
)

func main() {
    // åˆ›å»º MCP Client
    client := mcp.NewClient(mcp.ClientConfig{
        Name:    "my-client",
        Version: "1.0.0",
        Timeout: 30 * time.Second,
    })
    
    // è¿æ¥åˆ°å¤–éƒ¨ MCP Serverï¼ˆPython å®ç°çš„ï¼‰
    err := client.Connect(context.Background(), "stdio://path/to/python_mcp_server")
    if err != nil {
        log.Fatal(err)
    }
    defer client.Disconnect(context.Background())
    
    // åˆ—å‡ºèµ„æº
    resources, err := client.ListResources(context.Background())
    if err != nil {
        log.Fatal(err)
    }
    
    for _, res := range resources {
        fmt.Printf("èµ„æº: %s (%s)\n", res.Name, res.URI)
    }
    
    // è°ƒç”¨å·¥å…·
    result, err := client.CallTool(context.Background(), "analyze", map[string]any{
        "data": []float64{1, 2, 3, 4, 5},
    })
    if err != nil {
        log.Fatal(err)
    }
    
    fmt.Printf("ç»“æœ: %s\n", result.Content[0].Text)
}
```

### 2. MCP Server èšåˆå™¨

èšåˆå¤šä¸ª MCP Server çš„èƒ½åŠ›ã€‚

```go
type MCPAggregator struct {
    servers map[string]mcp.MCPClient
    mu      sync.RWMutex
}

func NewMCPAggregator() *MCPAggregator {
    return &MCPAggregator{
        servers: make(map[string]mcp.MCPClient),
    }
}

func (a *MCPAggregator) AddServer(name string, client mcp.MCPClient) {
    a.mu.Lock()
    defer a.mu.Unlock()
    a.servers[name] = client
}

func (a *MCPAggregator) ListAllResources(ctx context.Context) ([]*mcp.Resource, error) {
    a.mu.RLock()
    defer a.mu.RUnlock()
    
    var allResources []*mcp.Resource
    for name, client := range a.servers {
        resources, err := client.ListResources(ctx)
        if err != nil {
            log.Printf("Error listing resources from %s: %v", name, err)
            continue
        }
        
        // æ·»åŠ æœåŠ¡å™¨åç§°åˆ° metadata
        for _, res := range resources {
            res.Metadata["server"] = name
        }
        
        allResources = append(allResources, resources...)
    }
    
    return allResources, nil
}
```

---

## è·¨è¯­è¨€ Agent åä½œ

### 1. Python Agent ä¸ Go Agent åä½œ

#### Python Agentï¼ˆä½¿ç”¨ A2A åè®®ï¼‰

```python
# python_agent.py
from langchain_go_a2a import A2AAgent, Task, TaskResult

class PythonAnalystAgent(A2AAgent):
    def __init__(self):
        super().__init__(
            agent_id="python-analyst",
            name="Python Data Analyst",
            capabilities=["data_analysis", "machine_learning", "visualization"]
        )
    
    async def send_task(self, task: Task) -> TaskResult:
        # ä½¿ç”¨ Python çš„æ•°æ®ç§‘å­¦å·¥å…·
        import pandas as pd
        import numpy as np
        
        data = task.input.data
        df = pd.DataFrame(data)
        
        # æ‰§è¡Œåˆ†æ
        result = {
            "mean": df.mean().to_dict(),
            "std": df.std().to_dict(),
            "corr": df.corr().to_json()
        }
        
        return TaskResult(
            type="data",
            data=result,
            confidence=0.95
        )

# æ³¨å†Œåˆ° Consul
if __name__ == "__main__":
    agent = PythonAnalystAgent()
    agent.register_to_consul("localhost:8500")
    agent.serve(port=8081)
```

#### Go Agent è°ƒç”¨ Python Agent

```go
package main

import (
    "context"
    "fmt"
    "log"
    
    "github.com/zhucl121/langchain-go/pkg/protocols/a2a"
)

func main() {
    // è¿æ¥åˆ° Consul
    registry := a2a.NewConsulRegistry(&api.Config{
        Address: "localhost:8500",
    })
    
    // å‘ç° Python Agent
    agents, err := registry.FindByCapability(context.Background(), "data_analysis")
    if err != nil {
        log.Fatal(err)
    }
    
    pythonAgent := agents[0]  // Python Analyst Agent
    
    // å‘é€ä»»åŠ¡
    task := &a2a.Task{
        ID:   "task-123",
        Type: a2a.TaskTypeAnalyze,
        Input: &a2a.TaskInput{
            Type: "data",
            Data: map[string]any{
                "values": [][]float64{
                    {1.0, 2.0, 3.0},
                    {4.0, 5.0, 6.0},
                },
                "columns": []string{"A", "B", "C"},
            },
        },
    }
    
    response, err := pythonAgent.SendTask(context.Background(), task)
    if err != nil {
        log.Fatal(err)
    }
    
    fmt.Printf("Python Agent åˆ†æç»“æœ: %+v\n", response.Result.Data)
}
```

### 2. JavaScript Agent é›†æˆ

#### Node.js Agent

```javascript
// javascript_agent.js
const { A2AAgent, TaskType } = require('@langchain-go/a2a-client');

class JavaScriptWebAgent extends A2AAgent {
  constructor() {
    super({
      id: 'js-web-agent',
      name: 'JavaScript Web Agent',
      capabilities: ['web_scraping', 'dom_manipulation', 'api_testing']
    });
  }
  
  async sendTask(task) {
    const puppeteer = require('puppeteer');
    
    // ä½¿ç”¨ Puppeteer è¿›è¡Œç½‘é¡µæ“ä½œ
    const browser = await puppeteer.launch();
    const page = await browser.newPage();
    await page.goto(task.input.url);
    
    const content = await page.content();
    await browser.close();
    
    return {
      type: 'text',
      content: content,
      confidence: 1.0
    };
  }
}

// æ³¨å†Œå¹¶å¯åŠ¨
const agent = new JavaScriptWebAgent();
agent.registerToConsul('localhost:8500');
agent.serve(8082);
```

---

## ä¼ä¸šç³»ç»Ÿé›†æˆ

### 1. ä¸ç°æœ‰ API é›†æˆ

#### REST API èµ„æºæä¾›è€…

```go
type APIResourceProvider struct {
    client  *http.Client
    baseURL string
    apiKey  string
}

func (p *APIResourceProvider) Read(ctx context.Context, uri string) (*mcp.ResourceContent, error) {
    // è§£æ URI: api://endpoint/path
    path := p.extractPath(uri)
    
    req, _ := http.NewRequestWithContext(ctx, "GET", p.baseURL+path, nil)
    req.Header.Set("Authorization", "Bearer "+p.apiKey)
    
    resp, err := p.client.Do(req)
    if err != nil {
        return nil, err
    }
    defer resp.Body.Close()
    
    body, _ := io.ReadAll(resp.Body)
    
    return &mcp.ResourceContent{
        URI:      uri,
        MimeType: "application/json",
        Text:     string(body),
    }, nil
}

// æ³¨å†Œ API èµ„æº
apiProvider := &APIResourceProvider{
    client:  http.DefaultClient,
    baseURL: "https://api.company.com",
    apiKey:  os.Getenv("API_KEY"),
}

server.RegisterResource(&mcp.Resource{
    URI:  "api://company/users",
    Name: "User API",
}, apiProvider)
```

### 2. ä¸æ•°æ®åº“é›†æˆ

#### å¤æ‚æŸ¥è¯¢æ”¯æŒ

```go
type AdvancedDatabaseProvider struct {
    db *sql.DB
}

func (p *AdvancedDatabaseProvider) Read(ctx context.Context, uri string) (*mcp.ResourceContent, error) {
    // è§£æ URI: db://database/query?params
    query, params := p.parseURI(uri)
    
    rows, err := p.db.QueryContext(ctx, query, params...)
    if err != nil {
        return nil, err
    }
    defer rows.Close()
    
    // è½¬æ¢ä¸º JSON
    results := p.rowsToJSON(rows)
    
    return &mcp.ResourceContent{
        URI:      uri,
        MimeType: "application/json",
        Text:     results,
    }, nil
}
```

### 3. ä¸æ¶ˆæ¯é˜Ÿåˆ—é›†æˆ

#### Kafka é›†æˆ

```go
type KafkaResourceProvider struct {
    consumer *kafka.Consumer
}

func (p *KafkaResourceProvider) Subscribe(ctx context.Context, uri string) (<-chan *mcp.ResourceContent, error) {
    // è§£æ URI: kafka://topic
    topic := p.extractTopic(uri)
    
    p.consumer.SubscribeTopics([]string{topic}, nil)
    
    contentChan := make(chan *mcp.ResourceContent)
    
    go func() {
        defer close(contentChan)
        
        for {
            select {
            case <-ctx.Done():
                return
            default:
            }
            
            msg, err := p.consumer.ReadMessage(100 * time.Millisecond)
            if err != nil {
                continue
            }
            
            contentChan <- &mcp.ResourceContent{
                URI:      uri,
                MimeType: "application/json",
                Text:     string(msg.Value),
            }
        }
    }()
    
    return contentChan, nil
}
```

---

## äº‘å¹³å°éƒ¨ç½²

### 1. Kubernetes éƒ¨ç½²

#### Deployment YAML

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: langchain-go-agent
spec:
  replicas: 3
  selector:
    matchLabels:
      app: langchain-go-agent
  template:
    metadata:
      labels:
        app: langchain-go-agent
    spec:
      containers:
      - name: agent
        image: company/langchain-go-agent:v0.6.1
        ports:
        - containerPort: 8080
          name: grpc
        - containerPort: 8081
          name: metrics
        env:
        - name: CONSUL_ADDRESS
          value: "consul:8500"
        - name: OPENAI_API_KEY
          valueFrom:
            secretKeyRef:
              name: api-keys
              key: openai
        resources:
          requests:
            memory: "256Mi"
            cpu: "100m"
          limits:
            memory: "512Mi"
            cpu: "500m"
        livenessProbe:
          httpGet:
            path: /health
            port: 8080
          initialDelaySeconds: 10
          periodSeconds: 10
        readinessProbe:
          httpGet:
            path: /ready
            port: 8080
          initialDelaySeconds: 5
          periodSeconds: 5
```

#### Service YAML

```yaml
apiVersion: v1
kind: Service
metadata:
  name: langchain-go-agent
spec:
  selector:
    app: langchain-go-agent
  ports:
  - name: grpc
    port: 8080
    targetPort: 8080
  - name: metrics
    port: 8081
    targetPort: 8081
  type: ClusterIP
```

### 2. Docker Compose éƒ¨ç½²

```yaml
version: '3.8'

services:
  consul:
    image: consul:latest
    ports:
      - "8500:8500"
    command: agent -server -ui -bootstrap-expect=1 -client=0.0.0.0
  
  agent-1:
    build: .
    environment:
      - CONSUL_ADDRESS=consul:8500
      - AGENT_ID=agent-1
      - AGENT_NAME=Research Agent
      - AGENT_CAPABILITIES=research,search,analysis
    depends_on:
      - consul
    ports:
      - "8080:8080"
  
  agent-2:
    build: .
    environment:
      - CONSUL_ADDRESS=consul:8500
      - AGENT_ID=agent-2
      - AGENT_NAME=Writer Agent
      - AGENT_CAPABILITIES=writing,editing,summarization
    depends_on:
      - consul
    ports:
      - "8081:8080"
  
  coordinator:
    build: ./coordinator
    environment:
      - CONSUL_ADDRESS=consul:8500
    depends_on:
      - consul
      - agent-1
      - agent-2
    ports:
      - "9000:9000"
  
  prometheus:
    image: prom/prometheus:latest
    volumes:
      - ./prometheus.yml:/etc/prometheus/prometheus.yml
    ports:
      - "9090:9090"
  
  grafana:
    image: grafana/grafana:latest
    ports:
      - "3000:3000"
    environment:
      - GF_SECURITY_ADMIN_PASSWORD=admin
```

### 3. AWS éƒ¨ç½²

#### ECS Task Definition

```json
{
  "family": "langchain-go-agent",
  "networkMode": "awsvpc",
  "requiresCompatibilities": ["FARGATE"],
  "cpu": "256",
  "memory": "512",
  "containerDefinitions": [
    {
      "name": "agent",
      "image": "123456789.dkr.ecr.us-east-1.amazonaws.com/langchain-go-agent:v0.6.1",
      "portMappings": [
        {
          "containerPort": 8080,
          "protocol": "tcp"
        }
      ],
      "environment": [
        {
          "name": "CONSUL_ADDRESS",
          "value": "consul.service.consul:8500"
        }
      ],
      "secrets": [
        {
          "name": "OPENAI_API_KEY",
          "valueFrom": "arn:aws:secretsmanager:us-east-1:123456789:secret:openai-api-key"
        }
      ],
      "logConfiguration": {
        "logDriver": "awslogs",
        "options": {
          "awslogs-group": "/ecs/langchain-go-agent",
          "awslogs-region": "us-east-1",
          "awslogs-stream-prefix": "ecs"
        }
      }
    }
  ]
}
```

### 4. ç›‘æ§å’Œå¯è§‚æµ‹æ€§

#### Prometheus é…ç½®

```yaml
# prometheus.yml
global:
  scrape_interval: 15s

scrape_configs:
  - job_name: 'langchain-go-agents'
    consul_sd_configs:
      - server: 'consul:8500'
        services: ['langchain-go-agent']
    relabel_configs:
      - source_labels: [__meta_consul_service]
        target_label: service
      - source_labels: [__meta_consul_node]
        target_label: node
```

#### Grafana Dashboard

```json
{
  "dashboard": {
    "title": "LangChain-Go A2A Metrics",
    "panels": [
      {
        "title": "Agent Status",
        "targets": [
          {
            "expr": "a2a_agent_health"
          }
        ]
      },
      {
        "title": "Task Duration",
        "targets": [
          {
            "expr": "histogram_quantile(0.95, rate(a2a_task_duration_seconds_bucket[5m]))"
          }
        ]
      },
      {
        "title": "Tasks Per Second",
        "targets": [
          {
            "expr": "rate(a2a_tasks_sent_total[1m])"
          }
        ]
      }
    ]
  }
}
```

---

## æœ€ä½³å®è·µ

### 1. å®‰å…¨

- âœ… ä½¿ç”¨ HTTPS/TLS åŠ å¯†ä¼ è¾“
- âœ… å¯ç”¨ RBAC æƒé™æ§åˆ¶
- âœ… å®šæœŸè½®æ¢ API å¯†é’¥
- âœ… è®°å½•å®¡è®¡æ—¥å¿—
- âœ… ä½¿ç”¨å¯†é’¥ç®¡ç†æœåŠ¡ï¼ˆKMSï¼‰

### 2. æ€§èƒ½

- âœ… ä½¿ç”¨è¿æ¥æ± 
- âœ… å¯ç”¨ç»“æœç¼“å­˜
- âœ… å®ç°è¶…æ—¶å’Œé‡è¯•
- âœ… ä½¿ç”¨è´Ÿè½½å‡è¡¡
- âœ… ç›‘æ§å…³é”®æŒ‡æ ‡

### 3. å¯é æ€§

- âœ… å®ç°å¥åº·æ£€æŸ¥
- âœ… ä½¿ç”¨æ•…éšœè½¬ç§»
- âœ… è®¾ç½®åˆç†çš„è¶…æ—¶
- âœ… å®ç°ç†”æ–­å™¨
- âœ… è®°å½•è¯¦ç»†æ—¥å¿—

### 4. å¯ç»´æŠ¤æ€§

- âœ… ä½¿ç”¨ç‰ˆæœ¬åŒ– API
- âœ… ç¼–å†™æ¸…æ™°çš„æ–‡æ¡£
- âœ… æä¾›ç¤ºä¾‹ä»£ç 
- âœ… å®ç°ä¼˜é›…å…³é—­
- âœ… ä½¿ç”¨é…ç½®ç®¡ç†

---

## æ•…éšœæ’æŸ¥

### å¸¸è§é—®é¢˜

#### 1. è¿æ¥å¤±è´¥

```bash
# æ£€æŸ¥ç½‘ç»œ
ping agent-host

# æ£€æŸ¥ç«¯å£
nc -zv agent-host 8080

# æ£€æŸ¥ DNS
nslookup agent-host

# æ£€æŸ¥é˜²ç«å¢™
iptables -L
```

#### 2. è®¤è¯å¤±è´¥

```bash
# æ£€æŸ¥ Token
echo $OPENAI_API_KEY

# æ£€æŸ¥æƒé™
# æŸ¥çœ‹ RBAC æ—¥å¿—

# æ£€æŸ¥è¯ä¹¦
openssl s_client -connect agent-host:8080
```

#### 3. æ€§èƒ½é—®é¢˜

```bash
# æ£€æŸ¥ CPU/å†…å­˜
top
htop

# æ£€æŸ¥ç½‘ç»œå»¶è¿Ÿ
ping agent-host
traceroute agent-host

# æŸ¥çœ‹æ—¥å¿—
tail -f /var/log/agent.log

# Prometheus æŒ‡æ ‡
curl http://localhost:8081/metrics
```

---

## æ›´å¤šèµ„æº

- [ç”¨æˆ·æŒ‡å—](./V0.6.1_USER_GUIDE.md)
- [MCP è§„èŒƒ](./V0.6.1_MCP_SPEC.md)
- [A2A è§„èŒƒ](./V0.6.1_A2A_SPEC.md)
- [API å‚è€ƒ](./V0.6.1_API_REFERENCE.md)
- [ç¤ºä¾‹ä»£ç ](../examples/)

---

**åˆ›å»ºæ—¥æœŸ**: 2026-01-22  
**æœ€åæ›´æ–°**: 2026-01-22  
**ç‰ˆæœ¬**: v0.6.1
