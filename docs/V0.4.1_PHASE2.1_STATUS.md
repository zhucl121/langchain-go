# NebulaGraph 集成 - 实施说明

## 📌 当前状态

**Phase 2.1 已启动，但遇到网络问题**

### 问题

在尝试安装 NebulaGraph Go 客户端时遇到网络错误：

```bash
go: module github.com/vesoft-inc/nebula-go/v3: Get "https://goproxy.cn/github.com/vesoft-inc/nebula-go/v3/@v/list": tls: failed to verify certificate: x509: OSStatus -26276
```

### 已完成

- ✅ 创建实施计划 (`docs/V0.4.1_PHASE2.1_PLAN.md`)
- ✅ 创建配置文件 (`retrieval/graphdb/nebula/config.go`)

### 待完成

- ⏳ 解决网络问题
- ⏳ 安装依赖：`github.com/vesoft-inc/nebula-go/v3`
- ⏳ 实现驱动器
- ⏳ 实现查询构建器
- ⏳ 实现图操作
- ⏳ 集成测试
- ⏳ Docker 配置

---

## 🔧 解决方案

### 选项 1: 修复网络问题

```bash
# 1. 清除 Go 模块缓存
go clean -modcache

# 2. 设置 GOPROXY
export GOPROXY=https://proxy.golang.org,direct

# 3. 或使用其他代理
export GOPROXY=https://goproxy.io,direct

# 4. 重试安装
go get github.com/vesoft-inc/nebula-go/v3
```

### 选项 2: 手动下载

```bash
# 从 GitHub 下载
git clone https://github.com/vesoft-inc/nebula-go.git
cd nebula-go
git checkout v3

# 在项目中引用本地版本
# 修改 go.mod:
replace github.com/vesoft-inc/nebula-go/v3 => ../nebula-go
```

### 选项 3: 暂时跳过

继续其他工作，稍后解决：
- 完善文档
- 更新 v0.4.1 总结
- 准备发布说明

---

## 📋 Phase 2.1 计划概要

### 目标

实现 NebulaGraph 图数据库驱动器，提供第二个图数据库选项。

### 架构

```
NebulaDriver (实现 GraphDB 接口)
    ├── Connection Pool
    ├── Session Management
    ├── nGQL Query Builder
    ├── Type Converter
    └── Operations
        ├── Node CRUD
        ├── Edge CRUD
        ├── Traverse
        └── Shortest Path
```

### 关键特性

1. **完全兼容 GraphDB 接口**
   - 与 Neo4j/Mock 相同的 API
   - 透明切换

2. **nGQL 查询支持**
   - INSERT VERTEX/EDGE
   - FETCH PROP
   - GO (遍历)
   - FIND SHORTEST PATH

3. **高性能**
   - 连接池管理
   - 批量操作
   - 并发安全

### 工作量

- 基础驱动器: 1天
- nGQL 查询构建器: 1天
- 图操作实现: 1天
- 测试和文档: 1天

**总计**: 4天

---

## 🎯 下一步

### 立即可做

1. **更新 v0.4.1 总结** - 包含 Phase 2.1 计划
2. **准备发布说明** - v0.4.1 正式版
3. **创建 Roadmap** - v0.4.2 和 v0.5.0

### 待网络问题解决后

1. 安装 `github.com/vesoft-inc/nebula-go/v3`
2. 实现 NebulaDriver
3. 实现 nGQL 查询构建器
4. 集成测试
5. Docker Compose 配置

---

## 💡 推荐行动

由于网络问题是暂时的，建议：

**选项 A**: 先完成其他工作
- 更新文档
- 准备 v0.4.1 发布
- 等待网络恢复

**选项 B**: 尝试修复网络
- 更换 GOPROXY
- 使用 VPN
- 手动下载依赖

**选项 C**: 推迟 Phase 2.1
- 先发布 v0.4.1 (当前功能已完整)
- 在 v0.4.2 中完成 NebulaGraph

---

## 📚 参考

- [NebulaGraph 官方文档](https://docs.nebula-graph.io/)
- [nebula-go GitHub](https://github.com/vesoft-inc/nebula-go)
- [nGQL 查询语言](https://docs.nebula-graph.io/3.0.0/3.ngql-guide/1.nGQL-overview/1.overview/)

---

**作者**: LangChain-Go Team  
**日期**: 2026-01-21  
**状态**: 网络问题待解决
